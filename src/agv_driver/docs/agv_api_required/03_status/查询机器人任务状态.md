![...](..\..\TCP-IP%20API\机器人状态API\images\查询机器人任务状态.001.png)

**查询机器人任务状态**

**请求**

- 编号: 1110 (0x456)
- 名称: robot\_status\_task\_status\_package\_req
- 描述: 查询机器人任务状态
- JSON 数据区: 见下表

```字段名|类型|描述|可缺省``` :- | :- | :- |
|<p>task\_ids</p><p></p>|array[string]|数组中指定所需查询的任务 task\_id<br>如果数组为空，则响应也为空；<br>如果缺省该字段，则返回机器人最近已完成的一个任务状态和所有未完成的任务状态|是|

**请求示例**


```Plaintext
// 查询最近已完成的一个任务和所有未完成
5A 01 00 01 00 00 00 00 04 56 00 00 00 00 00 00```


```Plaintext
// 查询任务 id 为 SEER78909 的任务状态
// {"task\_ids": ["SEER78909"]}
5A 01 00 01 00 00 00 1B 04 56 00 00 00 00 00 00 
7B 22 74 61 73 6B 5F 69 64 73 22 3A 20 5B 22 53 45 45 52 37 38 39 30 39 22 5D 7D```

**响应**

- 编号: 11110 (0x2B66)
- 名称: robot\_status\_task\_status\_package\_res
- 描述: 查询机器人任务状态的响应
- JSON 数据区: 见下表


```如果响应数据区的 JSON Object 中有 API 中未提到的 key-value 键值对，可以直接忽略，无须关注其含义，下文不再赘述```


```字段名|类型|描述|可缺省``` :- | :- | :- |
|closest\_target|string|一定直线距离内（该距离是rbk内的一个参数），离机器人最近的站点。可能为空串，表示机器人周围没有站点|是|
|source\_name|string|机器人当前正执行的导航任务中的 "source\_id"|是|
|target\_name|string|机器人当前正执行的导航任务中的 "id"|是|
|percentage|number|机器人当前正执行的导航任务中，对于相应的路径，机器人已经走完的部分，占整条路径的比例|是|
|distance|number|机器人 到 “当前正执行的导航任务所对应的路径” 的投影距离|是|
|task\_status\_list|array[object]|任务状态列表（字段说明详见下表）|是|
|info|string|机器人在导航过程中，对使用者的一些提示，可以将其输出到前台。该字段不参与实际的逻辑判断|是|
|ret\_code|number|API 错误码|是|
|create\_on|string|API 上传时间戳|是|
|err\_msg|string|错误信息|是|

其中，task\_status\_list 中相关参数说明

```字段名|类型|描述|可缺省``` :- | :- | :- |
|task\_id|string|任务 id|是|
|status|number|任务状态<br>StatusNone = 0<br>Waiting = 1<br>Running = 2<br>Suspended = 3<br>Completed = 4<br>Failed = 5<br>Canceled = 6<br>OverTime = 7<br>NotFound = 404|是|

**响应示例**

如下数据表示机器人正在使用指定路径导航的方式依次去 AP62 -> AP5 -> AP67，返回最后已完成的任务和所有未完成的任务列表

```JSON
{
  "ret\_code": 0,
  "task\_status\_package": {
    "closest\_target": "AP67",
    "distance": 0.00287,
    "info": "",
    "percentage": 0.93491,
    "source\_name": "AP5",
    "target\_name": "AP67",
    "task\_status\_list": [
      {
        "status": 4,
        "task\_id": "SEER78914",
        "type": 3
      },
      {
        "status": 2,
        "task\_id": "SEER78915",
        "type": 3
      }
    ]
  }
}```

只返回 task\_id 为 " SEER78914 " 的任务状态

```JSON
{
  "ret\_code": 0,
  "task\_status\_package": {
    "closest\_target": "AP67",
    "distance": -1,
    "info": "",
    "percentage": 0,
    "source\_name": "",
    "target\_name": "",
    "task\_status\_list": [
      {
        "status": 4,
        "task\_id": "SEER78914",
        "type": 3
      }
    ]
  }
}```


