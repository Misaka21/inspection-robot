![...](..\..\TCP-IP%20API\机器人状态API\images\查询机械臂状态.001.png)

**查询机械臂状态**

**请求**

- 编号: 1669 (0x0685)
- 名称: robot\_status\_armstatus\_req
- 描述: 查询机械臂状态
- JSON 数据区: 无

**请求示例**

无

**响应**

- 编号: 11669 (0x2D95)
- 名称: robot\_status\_armstatus\_res
- 描述: 查询机械臂状态的响应
- JSON 数据区: 见下

```响应数据是通过Message\_ArmInfo序列化为json得来，具体字段以message\_arminfo.proto中为准。```


```序列化为json时，使用的序列化参数如下```


```C++
std::string j\_str;
google::protobuf::util::JsonOptions opt;
opt.always\_print\_enums\_as\_ints = true;
opt.always\_print\_primitive\_fields = true;
opt.preserve\_proto\_field\_names = true;
google::protobuf::util::MessageToJsonString(msg, &j\_str, opt);```
**响应示例1：**

```JSON
{
  "enabled": false,
  "safety\_mode": 0,
  "arm\_mode": 0,
  "DI": [],
  "DO": [],
  "robot\_status\_bits": [],
  "safety\_status\_bits": [],
  "taskId": 0,
  "task\_status": 0
}```
**响应示例2：**

```JSON
{
  "DI": [
  ],
  "DO": [
  ],
  "arm\_mode": 7,
  "base": {
    "angle": -1.6007002035724085,
    "current": 0,
    "temperature": 0,
    "velocity": 0,
    "voltage": 0
  },
  "create\_on": "2023-04-25T17:20:34.202+0800",
  "elbow": {
    "angle": -2.2029998938189905,
    "current": 0,
    "temperature": 0,
    "velocity": 0,
    "voltage": 0
  },
  "enabled": true,
  "endpos": {
    "rx": -0.00039174698543340767,
    "ry": 0.9998434776685855,
    "rz": 0.012478298683965675,
    "w": 0.012536297692776333,
    "x": -0.1799259141475472,
    "y": -0.6068697551627643,
    "z": 0.23078910206725664
  },
  "load": {
    "device\_name": "",
    "fx": 0,
    "fy": 0,
    "fz": 0,
    "mx": 0,
    "my": 0,
    "mz": 0
  },
  "ret\_code": 0,
  "robot\_status\_bits": [
    true,
    false,
    false,
    false
  ],
  "safety\_mode": 1,
  "safety\_status\_bits": [
    true,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false,
    false
  ],
  "scan": {
    "data": "",
    "name": "",
    "scan\_status": 1
  },
  "shoulder": {
    "angle": -1.7271001974688929,
    "current": 0,
    "temperature": 0,
    "velocity": 0,
    "voltage": 0
  },
  "taskId": 0,
  "task\_status": 2,
  "wrist1": {
    "angle": -0.8079999128924769,
    "current": 0,
    "temperature": 0,
    "velocity": 0,
    "voltage": 0
  },
  "wrist2": {
    "angle": 1.5951000452041626,
    "current": 0,
    "temperature": 0,
    "velocity": 0,
    "voltage": 0
  },
  "wrist3": {
    "angle": -0.03099996248354131,
    "current": 0,
    "temperature": 0,
    "velocity": 0,
    "voltage": 0
  }
}```
**说明：**

- 示例2针对针对UR机械臂上报的状态信息。其中机械臂状态的字段含义如下：

```C++
// Bits 0-3:
// | Is power on | Is program running
// | Is teach button pressed | Is power button pressed
std::vector<bool> armStatus;

// Bits 0-10:
// | Is normal mode | Is reduced mode
// | Is protective stopped | Is recovery mode
// | Is safeguard stopped | Is system emergency stopped
// | Is robot emergency stopped | Is emergency stopped
// | Is violation | Is fault | Is stopped due to safety
std::vector<bool> armSafeStatus;

//    \* -1 = ROBOT\_MODE\_NO\_CONTROLLER
//    \* 0 = ROBOT\_MODE\_DISCONNECTED
//    \* 1 = ROBOT\_MODE\_CONFIRM\_SAFETY
//    \* 2        = ROBOT\_MODE\_BOOTING
//    \* 3 = ROBOT\_MODE\_POWER\_OFF
//    \* 4 = ROBOT\_MODE\_POWER\_ON
//    \* 5        = ROBOT\_MODE\_IDLE
//    \* 6        = ROBOT\_MODE\_BACKDRIVE
//    \* 7        = ROBOT\_MODE\_RUNNING
//    \* 8        = ROBOT\_MODE\_UPDATING\_FIRMWARE
uint32\_t armMode;

//   1 : normal mode
//   2 : reduced mode
//   3 : recovery mode   (protective stoped)
uint32\_t armSafeMode;```
- 字段为[ ]的表示数据为空，该字段数据暂不上报。
- 除UR机械臂外的其他机械臂的状态字段数据暂未上报。

