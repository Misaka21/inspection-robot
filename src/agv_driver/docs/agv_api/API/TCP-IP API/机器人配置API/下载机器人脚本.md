![...](..\..\TCP-IP%20API\机器人配置API\images\下载机器人脚本.001.png)

**下载机器人脚本**

**请求**

- 编号: 4022 (0x0FB6)
- 名称: robot\_config\_downloadscript\_req
- 描述: 下载机器人脚本
- JSON 数据区: 见下表

```**字段名**|**类型**|**描述**|**可缺省**``` :- | :- | :- |
|<p>type</p><p></p>|string|机器人脚本的类型，“module”=机构脚本，“ genetic ”=通用脚本|否|
|relative\_path|string|脚本相对目录，与 [脚本查询 ](..\机器人状态API\查询机器人脚本列表.md)中的相同|否|

**请求示例**

如下表示下载机器人机构脚本 syspy/addMoveTaskList.py

```JSON
{
        "type": "module",
        "relative\_path": "syspy/addMoveTaskList.py"
}```

**响应**

- 编号: 14022 (0x36C6)
- 名称: robot\_config\_downloadscript\_res
- 描述: 下载机器人脚本的响应
- JSON 数据区: 见下

**响应示例**

```Python
import json
import time
from rbk import MoveStatus, BasicModule, ParamServer
from rbkSim import SimModule
"""
####BEGIN DEFAULT ARGS####
{
    "move\_task\_list": {
        "value": "",
        "tips": "任务",
        "unit": "",
        "type": "json"
    }
}
####END DEFAULT ARGS####
"""

"""
####BEGIN DESCRIPTION####
this is the description for this script
####END DESCRIPTION####
"""
class Module(BasicModule):
    """让音乐响起来,默认只播放一遍
    """
    def \_\_init\_\_(self, r:SimModule, args):
        super(Module, self).\_\_init\_\_()
        self.init = True    
        self.status = MoveStatus.NONE
        self.task = ""
    def run(self, r:SimModule,args):
        """主函数，每个运行周期都会执行run函数

        Args:
            r (SimModule): 是MoveFactory的类，包含了基本的电机控制，状态查询，消息查询的功能
            args ([type]): 输入参数，是个json类

        Returns:
            [type]: 返回运行状态，MoveStatus,用于表明脚本的运行状态
        """
        if self.status == MoveStatus.FINISHED:
            return self.status
        self.status = MoveStatus.RUNNING
        if self.init:
            self.task = args.get("move\_task\_list","")
            self.init = False
        r.logInfo(str(type(self.task)))
        if type(self.task) == str:
            r.addMoveTaskList(str(self.task))
        elif type(self.task) == dict or type(self.task) == list:
            r.addMoveTaskList(json.dumps(self.task))
        else:
            r.setError('args error {}'.format(json.dumps(args)))
        self.status = MoveStatus.FINISHED
        return self.status

if \_\_name\_\_ == '\_\_main\_\_':
    import rbkSim
    r = rbkSim.SimModule()
    m = Module(r,None)
    data = {"move\_task\_list":[{"id":"LM1","source\_id":"LM2","task\_id":"1"}]}
    print(m.run(r, data))```


