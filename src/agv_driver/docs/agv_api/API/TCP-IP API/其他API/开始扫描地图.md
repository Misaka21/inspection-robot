![...](..\..\TCP-IP%20API\其他API\images\开始扫描地图.001.png)

**开始扫描地图**

```<p>注意：</p><p>如果要接受实时的扫图数据, 请监听 UDP 19301 端口, 数据格式为二进制的 rbk.protocol.Message\_MapLog 。（3.4.6.17后使用19210端口主动上传）</p>```



```<p>注意：</p><p>如果要接受实时的扫图图像画面, 请求 HTTP 9301 端口，url: http://ip:9301/slam 方法为 Get ， content-type 为： image/png 。</p>```

**请求**

- 编号: 6100 (0x17D4)
- 名称: robot\_other\_slam\_req
- 描述: 开始扫描地图
- JSON 数据区: 见下表

```**字段名**|**类型**|**描述**|**可缺省**``` :- | :- | :- |
|slam\_type|int|<p>扫图类型：</p><p>1 = 2D扫图</p><p>2 = 2D实时扫图（real\_time 需要为 true）</p><p>3 = 3D扫图</p><p>4 = 3D实时扫图（real\_time 需要为 true）</p>|是|
|real\_time|bool|是否开启实时扫图数据传输, 默认为 false|是|
|screen\_width|number|屏幕宽(像素)|是|
|screen\_height|number|屏幕高(像素)|是|

**请求示例**


```JSON
5A 01 00 01 00 00 00 12 17 D4 00 00 00 00 00 00
{"real\_time":true}
// 序列化后十六进制为：
7B 22 72 65 61 6C 5F 74 69 6D 65 22 3A 74 72 75 
65 7D```

**响应**

- 编号: 16100 (0x3EE4)
- 名称: robot\_other\_slam\_res
- 描述: 开始扫描地图的响应
- JSON 数据区: 见下表

```**字段名**|**类型**|**描述**|**可缺省**``` :- | :- | :- |
|ret\_code|number|API 错误码|是|
|create\_on|string|API 上传时间戳|是|
|err\_msg|string|错误信息|是|

**响应示例**


```JSON
{
  "ret\_code": 0
}```


```Plaintext
5A 01 00 01 00 00 00 0E 3E E4 17 D4 00 00 00 00
7B 22 72 65 74 5F 63 6F 64 65 22 3A 30 7D```
**新增机制**

收到开始扫图的api且real\_time为true或slam\_type=4时开始订阅，当网络插件订阅到 Message\_MapLogData 消息时，请求方会持续收到响应直到收到停止扫图，报文编号为17002，json区为空，数据区为序列化的 Message\_MapLogData 消息。


